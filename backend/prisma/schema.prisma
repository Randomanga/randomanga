generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Manga {
  id String @id @default(uuid()) @db.Uuid

  title       Title          @relation(fields: [titleId], references: [id])
  description String
  cover       Cover?         @relation(fields: [coverId], references: [id])
  banner      String?
  tags        Category[]
  genres      String[]
  synonyms    String[]
  status      Status
  origin      String
  external    ExternalLinks? @relation(fields: [externalLinksId], references: [id])
  chapters    Int?
  volumes     Int?

  coverId         String? @db.Uuid
  titleId         String  @db.Uuid
  externalLinksId String  @db.Uuid

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

model Category {
  id        String        @id @default(uuid()) @db.Uuid
  name      String
  group     CategoryGroup
  Manga     Manga?        @relation(fields: [mangaId], references: [id])
  mangaId   String?       @db.Uuid
  updatedAt DateTime      @updatedAt
  createdAt DateTime      @default(now())
}

model Cover {
  id       String  @id @default(uuid()) @db.Uuid
  small    String
  original String
  large    String
  Manga    Manga[]
}

model Title {
  id      String  @id @default(uuid()) @db.Uuid
  english String?
  romaji  String?
  native  String?
  Manga   Manga[]
}

model ExternalLinks {
  id    String  @id @default(uuid()) @db.Uuid
  nu    String?
  mdex  String?
  mal   String?
  al    String?
  kitsu String?
  mu    String?
  Manga Manga[]
}

model User {
  id       String @id @default(uuid()) @db.Uuid
  username String
  email    String @unique
  password String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum Status {
  ONGOING
  COMPLETED
  HIATUS
  CANCELLED
}

enum CategoryGroup {
  GENRE
  TAG
}
